---
hide:
    - toc
---

## Facturas

| Método HTTP | Endpoint                     | Descripción                                     | Parámetros (Body/Query/Path)                                                                                                                                                                                                                                                      | Respuesta Exitosa                                                        | Respuesta de Error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Token de Login   |
| ----------- | ---------------------------- | ----------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------- |
| POST        | /api/facturas                | Crea una nueva factura.                         | **Body:** <br>`pedidosIds` (array de IDs) <br>`numeracion` (número de la factura) <br>`tipo` (tipo de pago: 'credito', 'contado', 'recibo') <br>`fechaPago` (fecha de pago) <br>`descripcion` (descripción) <br>`empresaId` (ID de empresa) <br>`particularId` (ID de particular) | 201 Created <br>JSON con los detalles de la factura creada               | 400 Bad Request <br>Debe proporcionar solo uno: empresaId o particularId. <br>400 Bad Request <br>Tipo de pago debe ser válido, opciones: ('credito', 'contado', 'recibo') <br>`400 Bad Request` <br>Debe proporcionar al menos un ID de pedido. <br>500 Internal Server Error <br>Error al crear la factura: { detalle: "mensaje de error" }                                                                                                                                                                                         | Requerido        |
| GET         | /api/facturas                | Obtiene una lista de facturas.                  | **Query:** <br>`ultimos` (número de facturas a recuperar) <br>`fechaInicio` (fecha de inicio) <br>`fechaFin` (fecha de fin) <br>`empresaId` (ID de empresa) <br>`particularId` (ID de particular) <br>`estado` (estado de la factura)                                             | 200 OK <br>JSON con la lista de facturas                                 | 400 Bad Request <br>`Debe proporcionar solo uno o ninguno: empresaId o particularId.` <br>400 Bad Request <br>`No se pueden traer más de 50 facturas a la vez` <br>`400 Bad Request` <br>`La factura solo puede estar: ('pendiente', 'anulada', 'pagada')` <br>`400 Bad Request` <br>`FechaFin debe ser después de fechaInicio` <br>`400 Bad Request` <br>`Debe ingresar fecha de inicio y fecha de fin` <br>500 Internal Server Error <br>`Error al obtener facturas: { detalle: "mensaje de error" }`                               | Requerido        |
| GET         | /api/facturas/:id            | Obtiene los detalles de una factura específica. | **Path:** <br>`facturaId` (ID de la factura)                                                                                                                                                                                                                                      | 200 OK <br>JSON con los detalles de la factura                           | 400 Not Found <br>`Factura no encontrada` <br>500 Internal Server Error <br>`Error al obtener la factura: { detalle: "mensaje de error" }`                                                                                                                                                                                                                                                                                                                                                                                            | Requerido        |
| PUT         | /api/facturas/:id            | Modifica una factura existente.                 | **Body:** <br>`numeracion` (número de la factura) <br>`tipo` (tipo de pago) <br>`fechaPago` (fecha de pago) <br>`descripcion` (descripción) <br>**Path:** <br>`facturaId` (ID de la factura)                                                                                      | 200 OK <br>JSON con los detalles de la factura modificada                | 400 Bad Request <br>`La fecha de pago debe ser válida` <br>400 Bad Request <br>`Tipo de pago debe ser válido, opciones: ('credito', 'contado', 'recibo')` <br>400 Not Found <br>`Factura no encontrada` <br>`400 Bad Request` <br>`No se puede modificar una factura anulada` <br>500 Internal Server Error <br>`Error al modificar Factura: { detalle: "mensaje de error" }`                                                                                                                                                         | Requerido        |
| PUT         | /api/facturas-recalcular/:id | Recalcula el monto de una factura.              | **Path:** <br>`facturaId` (ID de la factura)                                                                                                                                                                                                                                      | 200 OK <br>JSON con el detalle del monto recalculado                     | 400 Bad Request <br>`Factura no existe` <br>400 Bad Request <br>`Factura ya pagada` <br>`400 Bad Request` <br>`No se puede modificar una factura anulada` <br>500 Internal Server Error <br>`Error al modificar Factura: { detalle: "mensaje de error" }`                                                                                                                                                                                                                                                                             | Requerido        |
| PUT         | /api/facturas-estado/:id     | Cambia el estado de una factura.                | **Body:** <br>`fechaPago` (fecha de pago, si se cambia a 'pagada') <br>`estado` (nuevo estado: 'pagada', 'anulada', 'pendiente') <br>**Path:** <br>`facturaId` (ID de la factura)                                                                                                 | 200 OK <br>JSON con los detalles de la factura con el estado actualizado | 400 Bad Request <br>`Factura no existe` <br>400 Bad Request <br>`No se puede modificar una factura anulada` <br>`400 Bad Request` <br>`Factura ya está pagada` <br>`400 Bad Request` <br>`La fecha de pago es obligatoria y debe ser válida` <br>`400 Bad Request` <br>`Uno de los pedidos de esta factura ya está pagado.` <br>`400 Bad Request` <br>`Solo se puede cambiar a estado de factura: ('anulada', 'pagada', 'pendiente')` <br>500 Internal Server Error <br>`Error al modificar Factura: { detalle: "mensaje de error" }` | Requerido        |
| DELETE      | /api/facturas/:id            | Elimina una factura existente.                  | **Path:** <br>`facturaId` (ID de la factura)                                                                                                                                                                                                                                      | 201 Created <br>JSON con el mensaje de éxito                             | 400 Bad Request <br>`Factura no existe` <br>400 Bad Request <br>`No se puede eliminar una factura pagada` <br>500 Internal Server Error <br>`Error al Eliminar Factura: { detalle: "mensaje de error" }`                                                                                                                                                                                                                                                                                                                              | Requerido(Admin) |
